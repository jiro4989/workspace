= docker
:toc: left
:sectnums:

Docker上に構築した開発環境。

== コンテナ構成

Dockerfileはマルチステージ構成にしている。
ステージは2階層に分けており、それぞれ base ステージと言語ランタイムステージが存在する。
各言語ランタイムはいずれも base ステージを継承している。

* 共通ステージ
** base
* 言語ランタイムステージ
** go
** nim
** java
** node
** infra

上記ステージはいずれも base ステージを継承している。
すべてのステージで共通で必要なリソースは base ステージに定義している。

ランタイムステージ固有で必要なパッケージは各ランタイムのステージに定義する。
例えば、xrdpパッケージ等はGUIアプリの開発目的でしか使わず、現状GUIアプリはJavaで
しか作っていないため、 java ステージにのみ定義している。

== 使い方

=== ヘルプ出力

[source,bash]
----
make
----

=== 環境の立ち上げ

環境を立ち上げる。Dockerイメージがまだビルドされていなかったらビルドする。
停止中のコンテナが存在する場合はコンテナを再開する。

[source,bash]
----
make start TARGET=base
----

=== 環境の停止

コンテナを止める。 `TARGET` を指定しない場合はすべてのコンテナを止める。

[source,bash]
----
make stop
----

=== 環境の削除

コンテナを削除する。 `TARGET` を指定しない場合はすべてのコンテナを削除する。

[source,bash]
----
make clean
----
